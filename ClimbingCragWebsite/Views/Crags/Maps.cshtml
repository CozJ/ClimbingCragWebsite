@model List<ClimbingCragWebsite.Models.Crag>
<!--Leaflet CSS file-->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />

<div class="Main-Content-Form">
    <div id="mapid"></div>
</div>

@* Leaflet/MapboxScript *@
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
<script>
    var myMap = L.map('mapid', { zoomControl: false }).setView([52.3338, -1.2813], 7);

    L.control.zoom({
        position: 'bottomleft'
    }).addTo(myMap);

    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 18,
        minZoom: 7,
        id: 'mapbox/streets-v11',
        tileSize: 512,
        zoomOffset: -1,
        accessToken: 'pk.eyJ1IjoiY296aiIsImEiOiJja21oMGdnMnIwMm9nMndwa3E2OWttYmE3In0.4Q-wJD3k3PGithpbOhnfBw'
    }).addTo(myMap);

    $.ajax({
        url: "/Crags/GetLocations",
        success: function (data) {
            $(data).each(function (index, item) {
                console.log(data);
                var lat = item.latitude;
                var long = item.longitude;
                var name = item.cragName;
                var cragId = item.cragId;
                var link = "/Crags/CragDetails/" + encodeURI(cragId);
                L.marker([lat, long]).bindPopup("<a href=" + link + "><h4>" + name + "</h4></a>").addTo(myMap);
            })
        }
    })
</script>